##计算机网络

####1.OSI (Open System Interconnection) 开放系统互联

由于OSI是一个理想的模型，因此一般网络系统只涉及其中的几层，很少有系统能够具有所有的7层，并完全遵循它的规定。

在7层模型中，每一层都提供一个特殊的网络功能。从网络功能的角度观察：下面4层（物理层、数据链路层、网络层和传输层）主要提供数据传输和交换功能，即以节点到节点之间的通信为主；第4层作为上下两部分的桥梁，是整个网络体系结构中最关键的部分；而上3层（会话层、表示层和应用层）则以提供用户与应用程序之间的信息和数据处理功能为主。简言之，下4层主要完成通信子网的功能，上3层主要完成资源子网的功能

逻辑上分为七层模型：

#####（1）应用层（Application Layer） 
**[FTP HTTP SNMP]**

>应用层（Application Layer）是OSI参考模型的最高层，它是计算机用户，以及各种应用程序和网络之间的接口，其功能是直接向用户提供服务，完成用户希望在网络上完成的各种工作。它在其他6层工作的基础上，负责完成网络中应用程序与网络操作系统之间的联系，建立与结束使用者之间的联系，并完成网络用户提出的各种网络服务及应用所需的监督、管理和服务等各种协议。此外，该层还负责协调各个应用程序间的工作。

应用层为用户提供的服务和协议有：文件服务、目录服务、文件传输服务（FTP）、远程登录服务（Telnet）、电子邮件服务（E-mail）、打印服务、安全服务、网络管理服务、数据库服务等。上述的各种网络服务由该层的不同应用协议和程序完成，不同的网络操作系统之间在功能、界面、实现技术、对硬件的支持、安全可靠性以及具有的各种应用程序接口等各个方面的差异是很大的


#####HTTP协议的主要特点

+ 1.支持客户/服务器模式。
+ 2.简单快速：客户向服务器请求服务时，只需传送请求方法和路径。请求方法常用的有GET、HEAD、POST。每种方法规定了客户与服务器联系的类型不同。由于HTTP协议简单，使得HTTP服务器的程序规模小，因而通信速度很快。
+ 3.灵活：HTTP允许传输任意类型的数据对象。正在传输的类型由Content-Type加以标记。
+ 4.无连接：无连接的含义是限制每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接。采用这种方式可以节省传输时间。
+ 5.无状态：HTTP协议是无状态协议。无状态是指协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，在服务器不需要先前信息时它的应答就较快

#####HTTP状态码
主要分为五大类

状态码      描述          已定义范围      分类

1XX    信息性状态码        100~101      信息提示  
2XX    成功状态码          200~206      成功  
3XX    重定向状态码        300~305      重定向  
4XX    客户端错误状态码     400~415     客户端错误  
5XX    服务器错误状态码     500~505     服务器错误   



#####（2）表示层（Presentation Layer）

>表示层（Presentation Layer）是OSI模型的第六层，它对来自应用层的命令和数据进行解释，对各种语法赋予相应的含义，并按照一定的格式传送给会话层。其主要功能是“处理用户信息的表示问题，如编码、数据格式转换和加密解密”等。

表示层的具体功能如下：  

+ 数据格式处理：协商和建立数据交换的格式，解决各应用程序之间在数据格式表示上的差异。
+ 数据的编码：处理字符集和数字的转换。例如由于用户程序中的数据类型（整型或实型、有符号或无符号等）、用户标识等都可以有不同的表示方式，因此，在设备之间需要具有在不同字符集或格式之间转换的功能。
+ 压缩和解压缩：为了减少数据的传输量，这一层还负责数据的压缩与恢复。
+ 数据的加密和解密：可以提高网络的安全性


#####（3）会话层（Session Layer） 
**[NFS(Network File System, 网络文件系统)、 RPC(Remote Procedure Call, 远程过程调用)]**

>会话层（Session Layer）是OSI模型的第5层，是用户应用程序和网络之间的接口，主要任务是：向两个实体的表示层提供建立和使用连接的方法。将不同实体之间的表示层的连接称为会话。因此会话层的任务就是组织和协调两个会话进程之间的通信，并对数据交换进行管理

用户可以按照半双工、单工和全双工的方式建立会话。当建立会话时，用户必须提供他们想要连接的远程地址。而这些地址与MAC（介质访问控制子层）地址或网络层的逻辑地址不同，它们是为用户专门设计的，更便于用户记忆。域名（DN）就是一种网络上使用的远程地址例如：www.1234.com就是一个域名。

会话层的具体功能如下：

+ 会话管理：允许用户在两个实体设备之间建立、维持和终止会话，并支持它们之间的数据交换。例如提供单方向会话或双向同时会话，并管理会话中的发送顺序，以及会话所占用时间的长短。
+ 会话流量控制：提供会话流量控制和交叉会话功能。
+ 寻址：使用远程地址建立会话连接。
+ 出错控制：从逻辑上讲会话层主要负责数据交换的建立、保持和终止，但实际的工作却是接收来自传输层的数据，并负责纠正错误。会话控制和远程过程调用均属于这一层的功能。但应注意，此层检查的错误不是通信介质的错误，而是磁盘空间、打印机缺纸等类型的高级错误。


#####（4）传输层（Transport Layer）
[TCP、UDP、SPX]

>OSI下3层的主要任务是数据通信，上3层的任务是数据处理。而传输层（Transport Layer）是OSI模型的第4层。因此该层是通信子网和资源子网的接口和桥梁，起到承上启下的作用

该层的主要任务是：向用户提供可靠的端到端的差错和流量控制，保证报文的正确传输。传输层的作用是向高层屏蔽下层数据通信的细节，即向用户透明地传送报文。


#####（5）网络层（Network Layer）
[IP、RIP(Routing Information Protocol，路由信息协议)、OSPF(Open Shortest Path First，开放式最短路径优先)]

>网络层（Network Layer）是OSI模型的第三层，它是OSI参考模型中最复杂的一层，也是通信子网的最高一层。它在下两层的基础上向资源子网提供服务

其主要任务是：通过路由选择算法，为报文或分组通过通信子网选择最适当的路径。该层控制数据链路层与传输层之间的信息转发，建立、维持和终止网络的连接。具体地说，数据链路层的数据在这一层被转换为数据包，然后通过路径选择、分段组合、顺序、进/出路由等控制，将信息从一个网络设备传送到另一个网络设备。


#####（6）数据链路层（Data Link Layer）
[STP]

数据链路层（Data Link Layer）是OSI模型的第二层，负责建立和管理节点间的链路。该层的主要功能是：通过各种控制协议，将有差错的物理信道变为无差错的、能可靠传输数据帧的数据链路


#####（7）物理层（Physical Layer）

物理层的主要功能是：利用传输介质为数据链路层提供物理连接，实现比特流的透明传输。
物理层的作用是实现相邻计算机节点之间比特流的透明传送，尽可能屏蔽掉具体传输介质和物理设备的差异。使其上面的数据链路层不必考虑网络的具体传输介质是什么


####2.一些常见的缩写
DNS ： Domain Name Server 域名服务器
>用来把域名转换为 IP 地址

SMTP ： Simple Mail Transfer Protocol
>发送邮件使用的协议——简单邮件传送协议

POP3 ： Post Office Protocol version 3
>接收邮件使用的协议——邮局协议版本3

URL ： Uniform Resource Locator 统一资源定位符
>URL 用来标识万维网上的各种文档。  
 因特网上的每一个文档，在整个因特网的范围内具有惟一的标识符 URL。  
 URL 实际上就是文档在因特网中的地址

HTTP ： HyperText Transfer Protocol 超文本传送协议
>万维网客户程序与服务器程序之间的交互遵守超文本传送协议 HTTP

ARP ： Address Resolution Protocol 地址解析协议
>ARP 是解决同一个局域网上的主机或路由器的IP 地址和硬件地址的映射问题

RARP ： 逆地址解析协议

SSL ： Secure Sockets Layer 安全套接层

TCP ： Transmission Control Protocol 传输控制协议
>一种面向连接的、可靠的、基于字节流的通信协议，为传输大量数据或者需要接受数据许可的应用程序提供连接定向和可靠的通信

UDP ： User Datagram Protocol 用户数据报协议
>提供无连接的通信，不能保证数据包被发送到目标地址，典型的即时传输少量数据的应用程序通常使用UDP







####3.时延
时延(delay 或 latency)

+ 传输时延（发送时延) —— 从发送数据帧的第一个比特算起，到该帧的最后一个比特发送完     		毕所需的时间。 
+ 传播时延 —— 电磁波在信道中需要传播一定的距离而花费的时间。 
  >注：信号传输速率（即发送速率）和信号在信道上的传播速率是完全不同的概念。
+ 处理时延 —— 交换结点为存储转发而进行一些必要的处理所花费的时间。 
+ 排队时延 —— 结点缓存队列中分组排队所经历的时延。

总时延 = 发送时延+传播时延+处理时延+处理时延


####网络互相连接起来要使用一些中间设备
中间设备又称为中间系统或中继(relay)系统。

+ 物理层中继系统：转发器(repeater)、中继器。
+ 数据链路层中继系统：网桥或桥接器(bridge)。
+ 网络层中继系统：路由器(router)。
+ 网桥和路由器的混合物：桥路器(brouter)。
+ 网络层以上的中继系统：网关(gateway)。



####4.物理层
物理层的主要任务是确定与传输媒体的接口的一些特性，即：

+ 机械特性——指明接口所用接线器的形状和尺寸、引线数目和排列、固定和锁定装置等等。
+ 电气特性——指明在接口电缆的各条线上出现的电压的范围。
+ 功能特性——指明某条线上出现的某一电平的电压表示何种意义。
+ 过程特性——指明对于不同功能的各种可能事件的出现顺序

有关信号的几个基本概念

+ 单向通信（单工通信）——只能有一个方向的通信而没有反方向的交互。
+ 双向交替通信（半双工通信）——通信的双方都可以发送信息，但不能双方同时发送(当然也
就不能同时接收)。
+ 双向同时通信（全双工通信）——通信的双方可以同时发送和接收信息。

复用技术的分类：

+ 频分复用FDM(Frequency Division Multiplexing)
+ 时分复用TDM(Time Division Multiplexing)
+ 波分复用WDM(Wavelength Division Multiplexing)
+ 码分复用CDM(Code Division Multiplexing)


####5.数据链路层
数据链路层使用的信道主要有以下两种类型：

+ 点对点信道：这种信道使用一对一的点对点通信方式。  
+ 广播信道：这种信道使用一对多的广播通信方式，因此过程比较复杂。


传输数据时的三个基本问题:

(1) 封装成帧(framing)——在一段数据的前后分别添加首部和尾部，然后就构成了一个帧。首部
和尾部的一个重要作用就是进行帧定界。  
(2) 透明传输  
(3) 差错控制  

#####点对点协议PPP (Point-to-Point Protocol)
现在全世界使用得最多的数据链路层协议是点对点协议PPP。用户使用拨号电话线接入因特网
时，一般都是使用PPP 协议

1. PPP 协议应满足的需求

 简单——这是首要的要求
 封装成帧
 透明性
 多种网络层协议
 多种类型链路
 差错检测
 检测连接状态
 最大传送单元
 网络层地址协商
 数据压缩协商

2.PPP 协议不需要的功能
   纠错(只需要检测有无错，而不需纠错)
   流量控制
   序号
   多点线路
   半双工或单工链路
  
3.PPP 协议有三个组成部分
  1) 一个将IP 数据报封装到串行链路的方法。
  2) 链路控制协议LCP (Link Control Protocol)。
  3) 网络控制协议NCP (Network Control Protocol)
  
4.PPP 协议之不使用序号和确认机制.

#####CSMA/CD协议 【载波监听多点接入/冲突检测】
表示Carrier Sense Multiple Access with Collision Detection

“先听后发，边听边发，冲突停止，延迟重发”
【载波监听】【碰撞检测】【】【截断二进制指数退避算法】


####6.因特网中的两大类路由选择协议

#####内部网关协议IGP (Interior Gateway Protocol)
——即在一个自治系统内部使用的路由选择协议。
目前这类路由选择协议使用得最多，其具体的协议有多种，如RIP 和OSPF 协议：

+ RIP: Routing Information Protocol 路由信息协议  
RIP 协议的三个要点：
   + 仅和相邻路由器交换信息。  
   + 交换的信息是当前本路由器所知道的全部信息，即自己的路由表。  
   + 按固定的时间间隔交换路由信息，例如，每隔30 秒。  

+ OSPF：Open Shortest Path First 开放最短路径优先

#####外部网关协议EGP (External Gateway Protocol) 
—— 若源站和目的站处在不同的自治系统中，当数据报传到一个自治系统的边界时，就需要使用一种协议将路由选择信息传递到另一
个自治系统中。这样的协议就是外部网关协议EGP。在外部网关协议中目前使用最多的是BGP-4

+ BGP：Border Gateway Protocol 边界网关协议
   + BGP 是不同自治系统的路由器之间交换路由信息的协议。
   + 边界网关协议BGP 只能是力求寻找一条能够到达目的网络且比较好的路由
（不能兜圈子），而并非要寻找一条最佳路由


####7.网络层提供的两种服务

网络层提供两种类型的的服务，即：虚电路服务和数据报服务

+ 面向连接的通信方式
   + 建立虚电路(Virtual Circuit)，以保证双方通信所需的一切网络资源。
   + 虚电路表示这只是一条逻辑上的连接，分组都沿着这条逻辑连接按照存储转发方式传送，而并不是真正建立了一条物理连接。
   + 请注意，电路交换的电话通信是先建立了一条真正的连接。因此分组交换的
虚连接和电路交换的连接只是类似，但并不完全一样。
   + 如果再使用可靠传输的网络协议，就可使所发送的分组无差错按序到达终点。
+ 无连接的通信方式
   + 网络层向上只提供简单灵活的、无连接的、尽最大努力交付的数据报服务。


####8.运输层

[https://www.cnblogs.com/Andya/p/7272462.html]

[https://www.cnblogs.com/zmlctt/p/3690998.html]

主要功能：   
+ 运输层为应用进程之间提供端到端的逻辑通信（但网络层是为主机之间提供逻辑通信）。  
+ 运输层还要对收到的报文进行差错检测。  
+ 运输层需要有两种不同的运输协议，即面向连接的TCP 和无连接的UDP。 

+ TCP 的特点：
   + TCP 是面向连接的运输层协议。
   + 每一条TCP 连接只能有两个端点(endpoint)，每一条TCP 连接只能是点对点的（一对一）。
   + TCP 提供可靠交付的服务。
   + TCP 提供全双工通信。
   + 面向字节流。
   + 注意：
      + TCP 连接是一条虚连接而不是一条真正的物理连接。
      + TCP 对应用进程一次把多长的报文发送到TCP 的缓存中是不关心的。
      + TCP 根据对方给出的窗口值和当前网络拥塞的程度来决定一个报文段应包含多少个字节（UDP 发送的报文长度是应
用进程给出的）。
      + TCP 可把太长的数据块划分短一些再传送。TCP 也可等待积累有足够多的字节后再构成报文段发送出去。 


+ UDP 是面向报文的:
   + 发送方UDP 对应用程序交下来的报文，在添加首部后就向下交付IP 层。UDP 对应用层交下来的报文，既不合并，
也不拆分，而是保留这些报文的边界。
   + 应用层交给UDP 多长的报文，UDP 就照样发送，即一次发送一个报文。
   + 接收方UDP 对IP 层交上来的UDP 用户数据报，在去除首部后就原封不动地交付上层的应用进程，一次交付一个完整
的报文。
   + 应用程序必须选择合适大小的报文。


#####三次握手[图示在同目录下]
>首先Client端发送连接请求报文，Server段接受连接后回复ACK报文，并为这次连接分配资源。Client端接收到ACK报文后也向Server段发生ACK报文，并分配资源，这样TCP连接就建立了

所谓三次握手(Three-way Handshake)，是指建立一个TCP连接时，需要客户端和服务器总共发送3个包。

三次握手的目的是连接服务器指定端口，建立TCP连接,并同步连接双方的序列号和确认号并交换 TCP 窗口大小信息.在socket编程中，客户端执行connect()时。将触发三次握手。

#####四次挥手[图示在同目录下]
>TCP的连接的拆除需要发送四个包，因此称为四次挥手(four-way handshake)。客户端或服务器均可主动发起挥手动作，在socket编程中，任何一方执行close()操作即可产生挥手操作。


补充：

一、在TCP/IP协议中，TCP协议提供可靠的连接服务，采用三次握手建立一个连接，如图三次握手所示。
 
  (1) 第一次握手：建立连接时，客户端A发送SYN包(SYN=j)到服务器B，并进入SYN_SEND状态，等待服务器B确认。
 
  (2) 第二次握手：服务器B收到SYN包，必须确认客户A的SYN(ACK=j+1)，同时自己也发送一个SYN包(SYN=k)，即SYN+ACK包，此时服务器B进入SYN_RECV状态。
 
  (3) 第三次握手：客户端A收到服务器B的SYN＋ACK包，向服务器B发送确认包ACK(ACK=k+1)，此包发送完毕，客户端A和服务器B进入ESTABLISHED状态，完成三次握手。
 
 完成三次握手，客户端与服务器开始传送数据。
 
 二、由于TCP连接是全双工的，因此每个方向都必须单独进行关闭。这个原则是当一方完成它的数据发送任务后就能发送一个FIN来终止这个方向的连接。收到一个 FIN只意味着这一方向上没有数据流动，一个TCP连接在收到一个FIN后仍能发送数据。首先进行关闭的一方将执行主动关闭，而另一方执行被动关闭。
 
 （1）客户端A发送一个FIN，用来关闭客户A到服务器B的数据传送(报文段4)。
 
 （2）服务器B收到这个FIN，它发回一个ACK，确认序号为收到的序号加1(报文段5)。和SYN一样，一个FIN将占用一个序号。
 
 （3）服务器B关闭与客户端A的连接，发送一个FIN给客户端A(报文段6)。
 
 （4）客户端A发回ACK报文确认，并将确认序号设置为收到序号加1(报文段7)


#####三．为什么建立连接协议是三次握手，而关闭连接却是四次握手呢？

这是因为服务端的LISTEN状态下的SOCKET当收到SYN报文的连接请求后，它可以把ACK和SYN(ACK起应答作用，而SYN起同步作用)放在一个报文里来发送。但关闭连接时，当收到对方的FIN报文通知时，它仅仅表示对方没有数据发送给你了；但未必你所有的数据都全部发送给对方了，所以你可能未必会马上会关闭SOCKET,也即你可能还需要发送一些数据给对方之后，再发送FIN报文给对方来表示你同意现在可以关闭连接了，所以它这里的ACK报文和FIN报文多数情况下都是分开发送的


#####四. 为什么不能用两次握手进行连接？

我们知道，3次握手完成两个重要的功能，既要双方做好发送数据的准备工作(双方都知道彼此已准备好)，也要允许双方就初始序列号进行协商，这个序列号在握手过程中被发送和确认。
    
现在把三次握手改成仅需要两次握手，死锁是可能发生的。作为例子，考虑计算机S和C之间的通信，假定C给S发送一个连接请求分组，S收到了这个分组，并发 送了确认应答分组。按照两次握手的协定，S认为连接已经成功地建立了，可以开始发送数据分组。可是，C在S的应答分组在传输中被丢失的情况下，将不知道S 是否已准备好，不知道S建立什么样的序列号，C甚至怀疑S是否收到自己的连接请求分组。在这种情况下，C认为连接还未建立成功，将忽略S发来的任何数据分 组，只等待连接确认应答分组。而S在发出的分组超时后，重复发送同样的分组。这样就形成了死锁。
    
#####五.安全套接层SSL(Secure Socket Layer)

      SSL 可对万维网客户与服务器之间传送的数据进行加密和鉴别。
      SSL 在双方的联络阶段协商将使用的加密算法和密钥，以及客户与服务器之间的鉴别。
      在联络阶段完成之后，所有传送的数据都使用在联络阶段商定的会话密钥。
      SSL 不仅被所有常用的浏览器和万维网服务器所支持，而且也是运输层安全协议TLS (Transport
     Layer Security)的基础。

####9.数字签名和加密的区别

[https://blog.csdn.net/u014072325/article/details/21655851]

+ 数字签名

采用的是非对称密钥加密算法，能保证发送信息的完整性，身份认证和不可否认性。  
数字签名使用发送方的密钥对，发送方使用自己的私有密钥进行加密，而接收方只需要发送方的公开密钥就可以解密，
是一种一对多的关系，只要持有发送方公开密钥的人都可以验证数字签名的正确性。

+ 加密

采用的是对称密钥加密算法和非对称密钥加密算法相结合的方法  
加密是一种以密码方式发送信息的方法，发送方利用接收方的公钥对要发送的明文进行加密，接收方利用自己的私钥进行解密，
其中公钥很私钥都是相对的，任何一个作为公钥，则另一个就为私钥。

所以，加密使用的是接收方的密钥对，这是一种一对一的关系，任何知道接收方公钥的人都可以向接收方发送加密信息，
只有唯一拥有接收方私钥的人才能对信息解密。



####10.应用层

1、FTP (File Transfer Protocol) 概述  
+ FTP 是因特网上使用得最广泛的文件传送协议。  
+ FTP 提供交互式的访问，允许客户指明文件的类型与格式，并允许文件具有存取权限。  
+ FTP 屏蔽了各计算机系统的细节，因而适合于在异构网络中任意计算机之间传送文件  





